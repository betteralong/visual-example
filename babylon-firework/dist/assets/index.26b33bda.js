var T=Object.defineProperty;var S=(a,i,s)=>i in a?T(a,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[i]=s;var h=(a,i,s)=>(S(a,typeof i!="symbol"?i+"":i,s),s);import{M as f,V as l,P as u,T as v,C as m,a as y,E as b,S as P,b as R,A as C,c as B,B as N,d as x}from"./vendor.c55a8b7e.js";const L=function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))o(t);new MutationObserver(t=>{for(const e of t)if(e.type==="childList")for(const r of e.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&o(r)}).observe(document,{childList:!0,subtree:!0});function s(t){const e={};return t.integrity&&(e.integrity=t.integrity),t.referrerpolicy&&(e.referrerPolicy=t.referrerpolicy),t.crossorigin==="use-credentials"?e.credentials="include":t.crossorigin==="anonymous"?e.credentials="omit":e.credentials="same-origin",e}function o(t){if(t.ep)return;t.ep=!0;const e=s(t);fetch(t.href,e)}};L();class M{constructor(i){this.scene=i,this.isTop=!1,this.timer=0,this.isFired=!1,this.timer1=0,this.textureFirework="textures/flare.png",this.posX=0,this.posY=0,this.posZ=0}shoot(i=0,s=-20,o=0){let t=new f.CreateSphere("Shoot",4,1,this.scene);t.position=new l(i,s,o),t.isVisible=!1;let e=new u("particles",350,this.scene);e.particleTexture=new v(this.textureFirework,this.scene),e.emitter=t,e.minEmitBox=new l(0,0,0),e.maxEmitBox=new l(0,0,0),e.color1=new m(1,.8,1,1),e.color2=new m(1,.5,1,1),e.colorDead=new m(0,0,.2,.5),e.minSize=1,e.maxSize=1,e.minLifeTime=.5,e.maxLifeTime=.5,e.emitRate=350,e.blendMode=u.BLENDMODE_ONEONE,e.direction1=new l(0,-2,0),e.direction2=new l(0,-2,0),e.minEmitPower=1,e.maxEmitPower=1,e.updateSpeed=.005;let r=function(d){for(let c=0;c<d.length;c++){let n=d[c];if(n.age+=this._scaledUpdateSpeed,n.age>=n.lifeTime){this.recycleParticle(n),c--;continue}else n.size-=.01,n.direction.scaleToRef(e._scaledUpdateSpeed,e._scaledDirection),n.position.addInPlace(e._scaledDirection),e.gravity.scaleToRef(e._scaledUpdateSpeed,e._scaledGravity),n.direction.addInPlace(e._scaledGravity)}};e.updateFunction=r,e.start(),this.scene.registerBeforeRender(()=>{if(!this.isFired){if(!this.isTop)t.position.y+=.5,t.position.y>30&&(this.isTop=!this.isTop,this.isTop&&(this.posX=t.position.x,this.posY=t.position.y,this.posZ=t.position.z),e.stop(),t.position.x-=.5);else if(this.timer+=5,this.timer==125){for(let d=0;d<2;d++)this.firework();this.isFired=!this.isFired}}})}getRandomBetween(i,s){let o=s-i,t=Math.random();return i+Math.round(t*o)}firework(){let i=new f.CreateSphere("explosion",4,1,this.scene);i.isVisible=!1,i.position.x=this.posX,i.position.y=this.posY,i.position.z=this.posZ;let s=i;s.useVertexColors=!0;let o=s.getVerticesData(y.PositionKind),t=s.getVerticesData(y.NormalKind),e=[];for(let r=0;r<o.length;r+=3){let d=new l(o[r],o[r+1],o[r+2]),c=new l(t[r],t[r+1],t[r+2]),n=Math.random(),w=Math.random(),g=Math.random(),_=1,E=new m(n,w,g,_);e.push(n),e.push(w),e.push(g),e.push(_);let p=f.CreateBox("gizmo",.001,this.scene);p.position=d,p.parent=s,this.createParticleSystem(p,c.normalize().scale(1),E)}s.setVerticesData(y.ColorKind,e)}createParticleSystem(i,s,o){let t=!1,e=new u("particles",500,this.scene),r=function(d){for(let c=0;c<d.length;c++){let n=d[c];if(n.age+=this._scaledUpdateSpeed,n.age>=n.lifeTime){this.recycleParticle(n),c--;continue}else t||(n.size=n.size+.005,n.size>=.162&&(t=!t)),n.direction.scaleToRef(e._scaledUpdateSpeed,e._scaledDirection),n.position.addInPlace(e._scaledDirection),e.gravity.scaleToRef(e._scaledUpdateSpeed,e._scaledGravity),n.direction.addInPlace(e._scaledGravity)}};e.updateFunction=r,e.domeRadius=10,e.particleTexture=new v(this.textureFirework,this.scene),e.emitter=i,e.minEmitBox=new l(1,0,0),e.maxEmitBox=new l(1,0,0),e.color1=o,e.color2=o,e.colorDead=new m(0,0,0,0),e.minSize=.1,e.maxSize=.1,e.minLifeTime=1,e.maxLifeTime=2,e.emitRate=500,e.blendMode=u.BLENDMODE_ONEONE,e.gravity=new l(0,-9.81,0),e.direction1=s,e.direction2=s,e.minEmitPower=10,e.maxEmitPower=13,e.updateSpeed=.01,e.start(),this.scene.registerBeforeRender(()=>{this.timer1<300?this.timer1+=.15:e.stop()})}}const O=(a,i)=>{let s=i-a,o=Math.random();return a+Math.round(o*s)};class z{constructor(){h(this,"_scene");h(this,"_canvas");h(this,"_engine");this._canvas=this._createCanvas(),this._engine=new b(this._canvas,!0),this._scene=new P(this._engine),this._scene.clearColor=R.Black,new C("ArcRotateCamera",-1,1,100,new l(0,0,0),this._scene).attachControl(this._canvas,!0),this._createPlayButton(),this._engine.runRenderLoop(()=>{this._scene.render()})}_createPlayButton(){const i=B.CreateFullscreenUI("UI"),s=N.CreateSimpleButton("playButton","\u53D1\u5C04");s.width="150px",s.height="40px",s.color="white",s.posi,s.cornerRadius=20,s.background="red",s.verticalAlignment=x.VERTICAL_ALIGNMENT_BOTTOM,s.horizontalAlignment=x.HORIZONTAL_ALIGNMENT_RIGHT,s.onPointerUpObservable.add(()=>{const o=O(-20,20);this.play(o)}),i.addControl(s)}play(i){new M(this._scene).shoot(i)}_createCanvas(i="babylon"){return document.documentElement.style.overflow="hidden",document.documentElement.style.overflow="hidden",document.documentElement.style.width="100%",document.documentElement.style.height="100%",document.documentElement.style.margin="0",document.documentElement.style.padding="0",document.body.style.overflow="hidden",document.body.style.width="100%",document.body.style.height="100%",document.body.style.margin="0",document.body.style.padding="0",this._canvas=document.createElement("canvas"),this._canvas.style.width="100%",this._canvas.style.height="100%",this._canvas.id=i,document.body.appendChild(this._canvas),this._canvas}}const D=new z;D.play();
